---
layout: wppost
title: Prime Factors of Factorial Numbers
author: Jan Marthedal Rasmussen
excerpt: Factorial numbers, \(n! = 1 \cdot 2 \cdots n\), grow very fast with \(n\).
  In fact, \(n! \sim \sqrt{2 \pi n} (n/e)^n\) according to <a href="http://en.wikipedia.org/wiki/Stirling's_approximation">Stirling's
  approximation</a>. The <a href="http://en.wikipedia.org/wiki/Prime_factor">prime
  factors</a> of a factorial number, however, are all relatively small, and the complete
  factorization of \(n!\) is quite easy to obtain.
date: 2010-10-30 08:47:19.000000000 +02:00
categories:
- mathematics
tags:
- prime numbers
- factorials
- stirling's formula
---
<p>Factorial numbers, \(n! = 1 \cdot 2 \cdots n\), grow very fast with \(n\). In fact, \(n! \sim \sqrt{2 \pi n} (n/e)^n\) according to <a href="http://en.wikipedia.org/wiki/Stirling's_approximation">Stirling&#8217;s approximation</a>. The <a href="http://en.wikipedia.org/wiki/Prime_factor">prime factors</a> of a factorial number, however, are all relatively small, and the complete factorization of \(n!\) is quite easy to obtain.</p>
<span></span>
<p>We will make use of the following fundamental theorem:</p>
<blockquote>
<p>\(p \mid a b\) for a prime \(p\), then \(p \mid a\) or \(p \mid b\).</p>
</blockquote>
<div style="float:right"><a href="{% amazon hardy-wright %}"><img src="{% bookcover hardy-wright %}" /></a></div>
<p>(Here, \(p \mid a\) means that \(p\) divides \(a\).) This is called Euclid&#8217;s First Theorem or <a href="http://en.wikipedia.org/wiki/Euclid's_lemma">Euclid&#8217;s Lemma</a>. For most, it is intuitively clear, but a proof can be found in, e.g., <a href="{% amazon hardy-wright %}">Hardy and Wright: An Introduction to the Theory of Numbers</a>.</p>
<p>An application of this theorem to factorial numbers is that if a prime \(p\) is a divisor of \(n!\) then \(p\) must be a divisor of at least one of the numbers \(1, 2, &#8230;, n\). This immediately implies</p>
<blockquote>
<p>Every prime factor of \(n!\) is less than or equal to \(n\).</p>
</blockquote>
<p>Conversely, every prime number between 2 and \(n\) must be a prime factor of \(n!\).</p>
<p>Let us introduce the notation \(d_a(b)\) as the number of times \(a\) divides into \(b\). Put more precisely, \(d_a(b) = k\) if and only if \(b/a^k\) is an integer while \(b/a^{k+1}\) is not.</p>
<p>We now seek to determine \(d_p(n!)\) for all primes \(p \leq n\). From Euclid&#8217;s First Theorem and the <a href="http://en.wikipedia.org/wiki/Fundamental_theorem_of_arithmetic">Fundamental Theorem of Arithmetic</a> follows:</p>
<p>
\[
d_p(n!) = d_p(1) + d_p(2) + \cdots + d_p(n)
\]</p>
<p>The trick here is not to consider the right-hand side term by term, but rather as a whole. Let us take</p>
<blockquote>
<p>42! = 1405006117752879898543142606244511569936384000000000</p>
</blockquote>
<p>and \(p=3\) as an example. How many of the numbers 1, 2, &#8230;, 42 are divisible by 3? Exactly \(\lfloor 42/3 \rfloor = 14\) of them. But this is not the total count, because some of them are divisible by 3 multiple times. So how many are divisible by \(3^2\)? \(\lfloor 42/3^2 \rfloor = 4\) of them. Similarly, \(\lfloor 42/3^3 \rfloor = 1\). And \(\lfloor 42/3^4 \rfloor = \lfloor 42/3^5 \rfloor = \ldots = 0\). So we have</p>
<p>\[
d_3(42!) = 14+4+1 = 19.
\]</p>
<p>This procedure is easily generalized and we have</p>
<div style="float:right">
(1)
</div>
<p>\[
d_p(n!) = \sum_{k=1}^\infty \left\lfloor \frac{n}{p^k} \right\rfloor
  = \sum_{k=1}^{\lfloor \log_p(n) \rfloor} \left\lfloor \frac{n}{p^k} \right\rfloor.
\]</p>
<p>This <a href="http://en.wikipedia.org/wiki/Factorial#Number_theory">identity</a> was found by the french mathematician <a href="http://en.wikipedia.org/wiki/Adrien-Marie_Legendre">Adrien-Marie Legendre</a> (see also <a href="{% amazon proofsbook %}">Aigner and Ziegler: Proofs from The Book</a>, page 8, where it is called Legendre&#8217;s Theorem).</p>
<p>Doing this for all primes in our example, we get</p>
<blockquote>
<p>\(42! = 2^{39} \cdot 3^{19} \cdot 5^9 \cdot 7^6 \cdot 11^3 \cdot 13^3 \cdot 17^2 \cdot 19^2 \cdot 23 \cdot 29 \cdot 31 \cdot 37 \cdot 41\).</p>
</blockquote>
<p>Notice how the exponents do not increase as the prime numbers increase. This is true in general. Assume that \(p\) and \(q\) are both primes and \(p &lt; q\). Then \(\log_p(n) \geq \log_q(n)\) and \(n/p^k \geq n/q^k\) for all positive integers \(k\). Using this in equation&nbsp;(1) we get</p>
<div style="float:right">
(2)
</div>
<p>\[
d_p(n!) \geq d_q(n!) \quad \hbox{for primes $p$, $q$ with $p &lt; q$}
\]</p>
<p>and thus</p>
<p>\[
d_2(n!) \geq d_3(n!) \geq d_5(n!) \geq d_7(n!) \geq d_{11}(n!) \geq \ldots
\]</p>
<p>What about \(d_k(n!)\) for composite numbers \(k\)? Given the factorization of both \(n!\) and \(k\), this is easy to compute. But if, e.g., the multiplicity of all prime factors of \(k\) are the same, then the relation&nbsp;(2) can be used. Consider \(d_{10}(m)\) for a positive integer \(m\). Since \(10 = 2 \cdot 5\) then</p>
<p>\[
d_{10}(m) = \min\{ d_2(m), d_5(m) \}.
\]</p>
<p>But if \(m=n!\) then we can use&nbsp;(2) and we have</p>
<p>\[
d_{10}(n!) = d_5(n!).
\]
</p>
<p>For instance,</p>
<blockquote>
<p>\(d_{10}(42!) = d_5(42!) = \lfloor 42/5 \rfloor + \lfloor 42/5^2 \rfloor = 8 + 1 = 9\),</p>
</blockquote>
<p>so there are 9 trailing zeros in the decimal representation of 42!.</p>
